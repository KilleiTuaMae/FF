import{a as vt}from"./chunk-NH6FPESW.js";import{a as _t}from"./chunk-YDNJ2WB2.js";import{a as X,c as Y,d as Z,e as $,f as tt,g as et,h as ot,i as at,j as it,k as rt,l as nt,m as st,n as lt,o as ct,p as dt,q as gt,r as pt,s as mt,t as ut,u as ht,x as Ct}from"./chunk-YODU3OYW.js";import"./chunk-4ZHN5DEK.js";import"./chunk-QUJFQN2Y.js";import"./chunk-RKMDPVSI.js";import"./chunk-OQ2NBUQ5.js";import"./chunk-ZEOY7T7S.js";import"./chunk-SWY7PPUO.js";import"./chunk-VU6BZRVF.js";import"./chunk-GBD7M335.js";import"./chunk-7FY2OE2O.js";import"./chunk-MMMQHFET.js";import"./chunk-GA3BBT5K.js";import"./chunk-TSSAVJK6.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-NACS65YO.js";import"./chunk-CKP3SGE2.js";import"./chunk-24437W6R.js";import{$ as V,E as u,F as i,G as r,H as P,N as y,O as C,P as _,T as k,U as S,V as I,W as E,X as A,Y as n,Z as v,_ as G,aa as T,ba as B,ca as R,fa as h,fb as K,ga as q,gb as U,ha as O,ia as N,j as p,ja as D,jb as J,k as m,ma as F,na as z,pa as j,q as c,qa as L,s as b,sa as Q,ta as W,u as w,ua as H,y as M}from"./chunk-MVW6VEH7.js";import"./chunk-LJSFQLFK.js";import"./chunk-YAB3BLXJ.js";import"./chunk-ITRQULCE.js";import"./chunk-JVTPOORY.js";import"./chunk-CLDSZD2A.js";import"./chunk-M2X7KQLB.js";import"./chunk-E2PI57JI.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{e as x}from"./chunk-JHI3MBHO.js";var ft=["gastosChart"];function xt(s,l){if(s&1){let d=y();i(0,"ion-item")(1,"ion-label")(2,"div")(3,"strong"),n(4),r()(),i(5,"div",8),n(6),h(7,"date"),r(),i(8,"div"),n(9),r()(),i(10,"ion-button",19),C("click",function(){let e=p(d).$implicit,o=_(2);return m(o.remover(e))}),n(11,"Remover"),r()()}if(s&2){let d=l.$implicit,t=_(2);A("border-left","6px solid "+t.getCategoriaColor(d.categoria)),c(4),v(d.descricao),c(2),V("",d.categoria," \u2014 ",O(7,6,d.criadoEm,"dd/MM/yyyy")),c(3),v(t.formatCurrency(d.valor))}}function bt(s,l){if(s&1&&(i(0,"ion-list"),M(1,xt,12,9,"ion-item",18),r()),s&2){let d=_();c(),u("ngForOf",d.ultimos)}}function Mt(s,l){s&1&&(i(0,"p",20),n(1,"Nenhum gasto adicionado ainda."),r())}var Gt=(()=>{let l=class l{constructor(t,e){this.gastosService=t,this.alertController=e,this.gastos=[],this.categorias=["Alimenta\xE7\xE3o","Casa","Compras","Transporte","Sa\xFAde","Outros"],this.quickValor=null,this.mesAtual="",this.totalMesAtual=0,this.ultimos=[]}ngOnInit(){this.mesAtual=new Date().toLocaleString("pt-BR",{month:"long"}),this.carregarGastos()}ngAfterViewInit(){setTimeout(()=>this.renderChart(),200)}ionViewWillEnter(){this.carregarGastos(),this.updateChart()}carregarGastos(){this.gastos=this.gastosService.getAll(),this.totalMesAtual=this.gastosService.totalForMonth(),this.ultimos=this.gastos.slice(-5).reverse()}abrirAlertDetalhado(){this.abrirAlertAdicionar()}formatCurrency(t){return(t??0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}getCategoriaColor(t){return this.gastosService.getCategoriaColor(t)}remover(t){this.gastosService.removerGastoByPredicate(e=>e.criadoEm===t.criadoEm&&e.descricao===t.descricao&&e.valor===t.valor),this.carregarGastos(),this.updateChart()}adicionarRapido(){if(!this.quickValor||isNaN(this.quickValor)||this.quickValor<=0){this.alertController.create({header:"Valor inv\xE1lido",message:"Digite um valor maior que zero.",buttons:["OK"]}).then(t=>t.present());return}this.gastosService.adicionarGasto({descricao:"Gasto R\xE1pido",valor:Number(this.quickValor),categoria:"Outros"}),this.quickValor=null,this.carregarGastos(),this.updateChart()}abrirAlertAdicionar(){return x(this,null,function*(){yield(yield this.alertController.create({header:"Adicionar Gasto",inputs:[{name:"descricao",type:"text",placeholder:"Descri\xE7\xE3o (ex: Supermercado)"},{name:"valor",type:"number",placeholder:"Valor (ex: 25.50)",attributes:{step:"0.01"}}],buttons:[{text:"Cancelar",role:"cancel"},{text:"Pr\xF3ximo",handler:e=>{let o=String(e.descricao??"").trim(),a=Number(e.valor);return!o||isNaN(a)||a<=0?!1:(setTimeout(()=>this._abrirAlertSelecionarCategoria({descricao:o,valor:a}),50),!0)}}]})).present()})}_abrirAlertSelecionarCategoria(t){return x(this,null,function*(){let e=this.categorias.map(a=>({type:"radio",label:a,value:a,checked:!1}));yield(yield this.alertController.create({header:"Categoria",inputs:e,buttons:[{text:"Cancelar",role:"cancel"},{text:"Adicionar",handler:a=>{let g=a??"Outros";return this.gastosService.adicionarGasto({descricao:t.descricao,valor:t.valor,categoria:g}),this.carregarGastos(),this.updateChart(),!0}}]})).present()})}renderChart(){let t=this.gastosChart?.nativeElement?.getContext("2d");if(!t)return;let e=this.gastosService.totalsByCategoryForMonth(),o=Object.keys(e),a=Object.values(e);this.chart&&this.chart.destroy(),this.chart=new vt(t,{type:"doughnut",data:{labels:o,datasets:[{data:a,backgroundColor:o.map(g=>this.gastosService.getCategoriaColor(g))}]},options:{plugins:{legend:{position:"bottom"}},maintainAspectRatio:!1}})}updateChart(){if(!this.chart){setTimeout(()=>this.renderChart(),80);return}let t=this.gastosService.totalsByCategoryForMonth(),e=Object.keys(t),o=Object.values(t);this.chart.data.labels=e,this.chart.data.datasets[0].data=o,this.chart.data.datasets[0].backgroundColor=e.map(a=>this.gastosService.getCategoriaColor(a)),this.chart.update()}};l.\u0275fac=function(e){return new(e||l)(b(_t),b(ht))},l.\u0275cmp=w({type:l,selectors:[["app-gastos"]],viewQuery:function(e,o){if(e&1&&k(ft,5),e&2){let a;S(a=I())&&(o.gastosChart=a.first)}},decls:43,vars:17,consts:[["gastosChart",""],["semGastos",""],[3,"translucent"],["color","tertiary"],["slot","start"],[1,"ion-padding",3,"fullscreen"],[1,"resumo-top",2,"display","flex","gap","16px","align-items","center"],[2,"flex","1"],[1,"muted"],[1,"titulo-pequeno"],[2,"width","160px","height","120px"],[2,"width","100%","height","100%"],["size","8"],["type","number","placeholder","Valor r\xE1pido (ex: 25.50)","inputmode","decimal",3,"ngModelChange","ngModel"],["size","4"],["expand","block","color","primary",3,"click"],["expand","block","fill","outline",3,"click"],[4,"ngIf","ngIfElse"],[3,"border-left",4,"ngFor","ngForOf"],["fill","clear","slot","end","color","danger",3,"click"],[1,"ion-text-center","muted"]],template:function(e,o){if(e&1){let a=y();i(0,"ion-header",2)(1,"ion-toolbar",3)(2,"ion-buttons",4),P(3,"ion-menu-button"),r(),i(4,"ion-title"),n(5,"Gastos"),r()()(),i(6,"ion-content",5)(7,"ion-card")(8,"ion-card-header")(9,"ion-card-title"),n(10,"Resumo do M\xEAs"),r()(),i(11,"ion-card-content")(12,"div",6)(13,"div",7)(14,"div"),n(15,"Total: "),i(16,"strong"),n(17),h(18,"number"),h(19,"currency"),r()(),i(20,"div",8),n(21,"Categorias do m\xEAs"),r(),i(22,"div",9),n(23),h(24,"titlecase"),r()(),i(25,"div",10),P(26,"canvas",11,0),r()()()(),i(28,"ion-grid")(29,"ion-row")(30,"ion-col",12)(31,"ion-item")(32,"ion-input",13),R("ngModelChange",function(f){return p(a),B(o.quickValor,f)||(o.quickValor=f),m(f)}),r()()(),i(33,"ion-col",14)(34,"ion-button",15),C("click",function(){return p(a),m(o.adicionarRapido())}),n(35,"Adicionar R\xE1pido"),r()()(),i(36,"ion-row")(37,"ion-col")(38,"ion-button",16),C("click",function(){return p(a),m(o.abrirAlertDetalhado())}),n(39,"Adicionar Gasto Detalhado"),r()()()(),M(40,bt,2,1,"ion-list",17)(41,Mt,2,0,"ng-template",null,1,D),r()}if(e&2){let a=E(42);u("translucent",!0),c(6),u("fullscreen",!0),c(11),v(N(19,10,O(18,7,o.totalMesAtual,"1.2-2"),"BRL","symbol","1.2-2")),c(6),G("Gastos de ",q(24,15,o.mesAtual)),c(9),T("ngModel",o.quickValor),c(8),u("ngIf",o.ultimos.length>0)("ngIfElse",a)}},dependencies:[Ct,Y,Z,$,tt,et,ot,at,it,rt,nt,st,lt,ct,dt,gt,pt,mt,ut,X,H,F,z,J,K,U,Q,j,W,L],styles:['@charset "UTF-8";[_nghost-%COMP%]{display:block;--card-radius: 12px;--card-shadow: 0 6px 18px rgba(66, 46, 107, .06)}.toolbar-lavanda[_ngcontent-%COMP%]{background:linear-gradient(90deg,var(--color-lavanda-claro),var(--color-lavanda));color:var(--ion-color-primary-contrast);--min-height: 64px;box-shadow:none}.page-gastos[_ngcontent-%COMP%]{background:var(--ion-color-light);min-height:100%}.page-gastos[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 12px;color:var(--ion-color-dark);font-weight:600}.filtros-card[_ngcontent-%COMP%]{margin-bottom:12px}.filtros-card[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{border-radius:var(--card-radius);box-shadow:var(--card-shadow);overflow:hidden}.filtros-card[_ngcontent-%COMP%]   .filtros-content[_ngcontent-%COMP%]{padding:12px}.filtros-card[_ngcontent-%COMP%]   .filtros-row[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:end;flex-wrap:wrap}.filtros-card[_ngcontent-%COMP%]   .filtro-item[_ngcontent-%COMP%]{flex:1 1 220px;--background: transparent}.filtros-card[_ngcontent-%COMP%]   .acoes-filtro[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.totais-row[_ngcontent-%COMP%]{margin-bottom:12px;display:flex;gap:12px;align-items:center}.total-card[_ngcontent-%COMP%]{flex:1;border-radius:var(--card-radius);box-shadow:var(--card-shadow);background:linear-gradient(180deg,#ab9cea1f,#ab9cea0a);color:var(--ion-color-dark);padding:8px 12px}.total-card[_ngcontent-%COMP%]   .total-label[_ngcontent-%COMP%]{font-size:.9rem;color:var(--ion-color-medium)}.total-card[_ngcontent-%COMP%]   .total-valor[_ngcontent-%COMP%]{font-size:1.6rem;font-weight:700;margin-top:6px;color:var(--color-lavanda-escuro)}.grupo-dia[_ngcontent-%COMP%]{margin-bottom:12px}.dia-card[_ngcontent-%COMP%]{border-radius:var(--card-radius);box-shadow:var(--card-shadow);overflow:hidden}.dia-header[_ngcontent-%COMP%]{background:linear-gradient(90deg,var(--color-lavanda),var(--color-lavanda-escuro));color:var(--ion-color-primary-contrast);padding:10px 14px}.subtotal[_ngcontent-%COMP%]{font-weight:600;font-size:.95rem;opacity:.95}.table-wrap[_ngcontent-%COMP%]{overflow-x:auto}.gastos-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:.95rem;min-width:520px}.gastos-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background:linear-gradient(90deg,var(--color-lavanda-claro),transparent)}.gastos-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .gastos-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 12px;border-bottom:1px solid rgba(16,16,16,.04);vertical-align:middle;color:var(--ion-color-dark)}.gastos-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:700;color:var(--ion-color-dark);text-transform:none;font-size:.85rem}.gastos-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#ab9cea08}.text-right[_ngcontent-%COMP%]{text-align:right}.text-center[_ngcontent-%COMP%]{text-align:center}ion-button[color=primary][_ngcontent-%COMP%]{--background: linear-gradient(90deg, var(--color-lavanda), var(--color-lavanda-escuro));--background-focused: linear-gradient(90deg, var(--color-lavanda-escuro), var(--color-lavanda));--color: var(--ion-color-primary-contrast);border-radius:10px;box-shadow:0 6px 18px #917ce11f}@media (max-width: 560px){.filtros-row[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.acoes-filtro[_ngcontent-%COMP%]{justify-content:flex-start}.gastos-table[_ngcontent-%COMP%]{min-width:420px}}']});let s=l;return s})();export{Gt as GastosPage};
