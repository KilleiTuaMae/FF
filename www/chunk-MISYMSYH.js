import{a as q}from"./chunk-GZDRO7QL.js";import{a as W}from"./chunk-NH6FPESW.js";import{a as K}from"./chunk-YDNJ2WB2.js";import{d as B,e as A,f as F,g as k,h as H,j as L,l as R,n as V,o as j,p as z,q as Q,s as U,t as N,x as $}from"./chunk-YODU3OYW.js";import"./chunk-4ZHN5DEK.js";import"./chunk-QUJFQN2Y.js";import"./chunk-RKMDPVSI.js";import"./chunk-OQ2NBUQ5.js";import"./chunk-ZEOY7T7S.js";import"./chunk-SWY7PPUO.js";import"./chunk-VU6BZRVF.js";import"./chunk-GBD7M335.js";import"./chunk-7FY2OE2O.js";import"./chunk-MMMQHFET.js";import"./chunk-GA3BBT5K.js";import"./chunk-TSSAVJK6.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-NACS65YO.js";import"./chunk-CKP3SGE2.js";import"./chunk-24437W6R.js";import{$ as M,E as l,F as t,G as e,H as f,P as m,T as y,U as I,V as S,Y as a,Z as p,_ as g,fa as C,g as v,ga as x,ha as b,jb as T,ma as P,na as E,pa as O,q as n,qa as w,ra as D,u as _,ua as G,y as h}from"./chunk-MVW6VEH7.js";import"./chunk-LJSFQLFK.js";import"./chunk-YAB3BLXJ.js";import"./chunk-ITRQULCE.js";import"./chunk-JVTPOORY.js";import"./chunk-CLDSZD2A.js";import"./chunk-M2X7KQLB.js";import"./chunk-E2PI57JI.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import"./chunk-JHI3MBHO.js";var X=["gastoChart"];function Y(i,r){if(i&1&&(t(0,"ion-item")(1,"ion-label"),a(2),t(3,"p",11),a(4),e()()()),i&2){let s=r.$implicit,o=m(2);n(2),g(" ",s.key," "),n(2),p(o.formatCurrency(o.resumo.porCategoria[s.key]||0))}}function Z(i,r){if(i&1&&(t(0,"ion-card",9)(1,"ion-card-header")(2,"ion-card-title"),a(3,"Categorias"),e()(),t(4,"ion-card-content")(5,"ion-list"),h(6,Y,5,2,"ion-item",10),C(7,"keyvalue"),e()()()),i&2){let s=m();n(6),l("ngForOf",x(7,1,s.resumo.porCategoria))}}function tt(i,r){if(i&1&&(t(0,"div")(1,"div")(2,"strong"),a(3),e()(),t(4,"div",11),a(5),C(6,"date"),e(),t(7,"div"),a(8),e(),f(9,"hr"),e()),i&2){let s=r.$implicit,o=m(2);n(3),p(s.descricao),n(2),M("",s.categoria," \u2014 ",b(6,4,s.criadoEm,"dd/MM/yyyy")),n(3),p(o.formatCurrency(s.valor))}}function et(i,r){if(i&1&&(t(0,"ion-card",9)(1,"ion-card-header")(2,"ion-card-title"),a(3,"\xDAltimos Gastos"),e()(),t(4,"ion-card-content"),h(5,tt,10,7,"div",10),e()()),i&2){let s=m();n(5),l("ngForOf",s.ultimos)}}var ut=(()=>{let r=class r{constructor(){this.nomeUsuario="",this.idade=0,this.gastos=[],this.totalGastos=0,this.mesAtual=new Date().toLocaleString("pt-BR",{month:"long"}),this.resumo={total:0,porCategoria:{}},this.ultimos=[],this.gastosService=v(K),this.authService=v(q)}ngOnInit(){let o=this.authService.getLoggedUser();this.nomeUsuario=o.nome,this.idade=o.idade,this.carregarDados()}ngAfterViewInit(){setTimeout(()=>this.criarGrafico(),300)}ionViewWillEnter(){this.carregarDados(),this.atualizarGrafico()}carregarDados(){this.gastos=this.gastosService.getAll(),this.totalGastos=this.gastosService.totalForMonth(),this.resumo.porCategoria=this.gastosService.totalsByCategoryForMonth(),this.resumo.total=this.totalGastos,this.ultimos=this.gastos.slice(0,5)}formatCurrency(o){return(o??0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}criarGrafico(){if(!this.gastoChart)return;let o=Object.keys(this.resumo.porCategoria),d=Object.values(this.resumo.porCategoria),c=o.map(J=>this.gastosService.getCategoriaColor(J)),u=this.gastoChart.nativeElement.getContext("2d");this.chart&&this.chart.destroy(),this.chart=new W(u,{type:"doughnut",data:{labels:o,datasets:[{data:d,backgroundColor:c}]},options:{plugins:{legend:{position:"bottom"}}}})}atualizarGrafico(){this.chart&&(this.chart.destroy(),this.criarGrafico())}};r.\u0275fac=function(d){return new(d||r)},r.\u0275cmp=_({type:r,selectors:[["app-home"]],viewQuery:function(d,c){if(d&1&&y(X,5),d&2){let u;I(u=S())&&(c.gastoChart=u.first)}},decls:27,vars:10,consts:[["gastoChart",""],[3,"translucent"],["color","tertiary"],["slot","start"],[1,"ion-padding",3,"fullscreen"],[1,"boas-vindas"],[2,"height","160px","margin-top","8px"],[2,"width","100%","height","100%"],["style","margin-top:12px;",4,"ngIf"],[2,"margin-top","12px"],[4,"ngFor","ngForOf"],[1,"muted"]],template:function(d,c){d&1&&(t(0,"ion-header",1)(1,"ion-toolbar",2)(2,"ion-buttons",3),f(3,"ion-menu-button"),e(),t(4,"ion-title"),a(5,"Home"),e()()(),t(6,"ion-content",4)(7,"div",5)(8,"h2"),a(9),e(),t(10,"p"),a(11),e()(),t(12,"ion-card")(13,"ion-card-header")(14,"ion-card-title"),a(15),C(16,"titlecase"),e()(),t(17,"ion-card-content")(18,"div"),a(19,"Total gasto: "),t(20,"strong"),a(21),e()(),t(22,"div",6),f(23,"canvas",7,0),e()()(),h(25,Z,8,3,"ion-card",8)(26,et,6,1,"ion-card",8),e()),d&2&&(l("translucent",!0),n(6),l("fullscreen",!0),n(3),g("Bem-vindo, ",c.nomeUsuario,"!"),n(2),g("Voc\xEA tem ",c.idade," anos e est\xE1 controlando bem suas finan\xE7as \u{1F4AA}"),n(4),g("Resumo - ",x(16,8,c.mesAtual)),n(6),p(c.formatCurrency(c.totalGastos)),n(4),l("ngIf",c.resumo.total>0),n(),l("ngIf",c.ultimos.length>0))},dependencies:[$,B,A,F,k,H,L,R,V,j,z,Q,U,N,G,P,E,T,O,w,D],styles:[".home-content[_ngcontent-%COMP%]{--background: #f8f5fc;padding:16px}.boas-vindas[_ngcontent-%COMP%]{text-align:center;margin:1rem 0;color:#6a1b9a}.resumo-card[_ngcontent-%COMP%]{background:#f3e5f5;border-radius:20px;box-shadow:0 3px 10px #9664c833}.categorias-card[_ngcontent-%COMP%]{background:#ede7f6;border-radius:20px;margin-top:1rem}.resumo-dados[_ngcontent-%COMP%]{display:flex;justify-content:space-between;text-align:center;margin-bottom:1rem}.resumo-dados[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:.9rem;color:#7b1fa2}.resumo-dados[_ngcontent-%COMP%]   .valor[_ngcontent-%COMP%]{font-weight:700;font-size:1.2rem}.resumo-dados[_ngcontent-%COMP%]   .gasto[_ngcontent-%COMP%]{color:#d32f2f}.resumo-dados[_ngcontent-%COMP%]   .guardado[_ngcontent-%COMP%]{color:#388e3c}.resumo-dados[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]{color:#512da8}canvas[_ngcontent-%COMP%]{width:100%!important;height:150px!important}"]});let i=r;return i})();export{ut as HomePage};
